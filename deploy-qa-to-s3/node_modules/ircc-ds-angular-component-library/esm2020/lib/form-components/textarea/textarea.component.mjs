import { Component, forwardRef, HostListener, Input } from '@angular/core';
import { FormGroup, NG_VALUE_ACCESSOR } from '@angular/forms';
import * as i0 from "@angular/core";
import * as i1 from "../../../shared/functions/stand-alone.functions";
import * as i2 from "@ngx-translate/core";
import * as i3 from "@angular/common";
import * as i4 from "../../shared/label/label.component";
import * as i5 from "@angular/forms";
import * as i6 from "../error/error.component";
export const MAX_CHAR_LIMIT_EN = 'Maximum character limit reached.';
export const MAX_CHAR_LIMIT_FR = 'Limite maximale de caractères atteinte.';
export const WARNING_CHAR_LIMIT_EN = 'Maximum character limit reached in 15 characters.';
export const WARNING_CHAR_LIMIT_FR = 'Limite maximale de caractères atteinte en 15 caractères.';
export var ResizableTypes;
(function (ResizableTypes) {
    ResizableTypes["vertical"] = "vertical";
    ResizableTypes["horizontal"] = "password";
    ResizableTypes["both"] = "both";
    ResizableTypes["none"] = "none";
})(ResizableTypes || (ResizableTypes = {}));
export class TextareaComponent {
    constructor(standAloneFunctions, translate) {
        this.standAloneFunctions = standAloneFunctions;
        this.translate = translate;
        this.formGroupEmpty = new FormGroup({});
        //DON'T include default values of '' unless it REALLY makes sense to do so. Instead, make them optional
        this.config = {
            id: '',
            formGroup: new FormGroup({})
        };
        this.id = '';
        this.formGroup = this.formGroupEmpty;
        this.charLimit = '';
        this.disabled = false;
        this.focusState = false;
        this.errorIds = [];
        this.charLimitStatus = '';
        this.currentCharacterStatusAria = '';
        this.currentStatus = 'VALID';
        this.announceCharStatusChangeAria = false;
        this.charLength = -1;
        this.labelConfig = {
            formGroup: this.config.formGroup,
            parentID: ''
        };
        this.isEventActive = false;
        this.announceMaxCharaterLimitReached = '';
        //Removed '!' and added null case in onChange
        this.onTouch = () => {
            if (this.config.formGroup?.get(this.config.id)?.touched === false) {
                this.config.formGroup?.get(this.config.id)?.markAsTouched();
            }
        };
        this.onChange = (value) => {
            this.config.formGroup.get(this.config.id)?.setValue(value);
        };
    }
    ngOnInit() {
        //set config from individual options, if present
        if (this.id !== '')
            this.config.id = this.id;
        if (this.formGroup !== this.formGroupEmpty)
            this.config.formGroup = this.formGroup;
        if (this.charLimit !== '')
            this.config.charLimit = this.charLimit;
        if (this.size)
            this.config.size = this.size;
        if (this.label)
            this.config.label = this.label;
        if (this.desc)
            this.config.desc = this.desc;
        if (this.hint)
            this.config.hint = this.hint;
        if (this.placeholder)
            this.config.placeholder = this.placeholder;
        if (this.required)
            this.config.required = this.required;
        if (this.resizable)
            this.config.resizable = this.resizable;
        if (this.errorMessages)
            this.config.errorMessages = this.errorMessages;
        if (this.errorIcon)
            this.config.errorIcon = this.errorIcon;
        if (this.config.charLimit != '' && this.config.charLimit) {
            this.charLength = 0;
        }
        if (this.config.errorMessages) {
            this.errorIds = this.standAloneFunctions.getErrorIds(this.config.formGroup, this.config.id, this.config.errorMessages);
        }
        if (this.config.formGroup.controls[this.config.id].value) {
            this.charLength =
                this.config.formGroup.controls[this.config.id].value.length;
            this.characterCountStatus(this.config.formGroup.controls[this.config.id].value.length);
        }
        this.config.formGroup.valueChanges.subscribe((change) => {
            this.characterCountStatus(change[this.config.id]?.length);
        });
        this.labelConfig = this.standAloneFunctions.makeLabelConfig(this.config.formGroup, this.config.id, this.config.errorMessages, this.config.label, this.config.desc, this.config.hint, this.config.required, this.config.labelIconConfig);
        this.currentStatus =
            this.config.formGroup.get(this.config.id)?.status || 'DISABLED';
        this.toggleDisabledState();
        this.config.formGroup
            .get(this.config.id)
            ?.statusChanges.subscribe((change) => {
            if (change !== this.currentStatus) {
                this.currentStatus = change;
                this.toggleDisabledState();
            }
        });
        this.translate.currentLang === 'en' || this.translate.currentLang === 'en-US'
            ? (this.announceMaxCharaterLimitReached = MAX_CHAR_LIMIT_EN)
            : (this.announceMaxCharaterLimitReached = MAX_CHAR_LIMIT_FR);
    }
    toggleDisabledState() {
        switch (this.currentStatus) {
            case 'DISABLED':
                this.setDisabledState(true);
                break;
            default:
                this.setDisabledState(false);
                break;
        }
    }
    ngOnChanges() {
        this.labelConfig = this.standAloneFunctions.makeLabelConfig(this.config.formGroup, this.config.id, this.config.errorMessages, this.config.label, this.config.desc, this.config.hint, this.config.required, this.config.labelIconConfig);
    }
    focusInput(focusValue) {
        this.focusState = !focusValue;
    }
    characterCountStatus(currCharCount) {
        let currLang = this.translate.currentLang;
        if (this.config?.charLimit) {
            if (this.config?.charLimit == currCharCount) {
                this.charLimitStatus = 'maxLimit';
                currLang === 'en' || currLang === 'en-US'
                    ? (this.currentCharacterStatusAria = MAX_CHAR_LIMIT_EN)
                    : (this.currentCharacterStatusAria = MAX_CHAR_LIMIT_FR);
                this.announceCharStatusChangeAria = true;
                this.isEventActive = true;
            }
            else if (Number(this.config?.charLimit) - currCharCount == 15) {
                this.charLimitStatus = 'warningLimit';
                currLang === 'en' || currLang === 'en-US'
                    ? (this.currentCharacterStatusAria = WARNING_CHAR_LIMIT_EN)
                    : (this.currentCharacterStatusAria = WARNING_CHAR_LIMIT_FR);
                this.announceCharStatusChangeAria = true;
                this.isEventActive = false;
            }
            else if (Number(this.config?.charLimit) - currCharCount < 15) {
                this.charLimitStatus = 'warningLimit';
                this.currentCharacterStatusAria = '';
                this.isEventActive = false;
            }
            else {
                this.charLimitStatus = '';
                this.currentCharacterStatusAria = '';
                this.isEventActive = false;
            }
        }
    }
    onBlur() {
        this.announceCharStatusChangeAria = false;
        if (this.config.formGroup.controls[this.config.id].value) {
            this.charLength =
                this.config.formGroup.controls[this.config.id].value.length;
        }
        else {
            this.charLength = 0;
        }
    }
    //Keep announcing max char limit reached for each keypress made after max limit has reached
    onKeyPress(event) {
        if (this.isEventActive) {
            if (this.announceMaxCharaterLimitReached === MAX_CHAR_LIMIT_EN || this.announceMaxCharaterLimitReached === MAX_CHAR_LIMIT_FR) {
                this.announceMaxCharaterLimitReached += '&nbsp;';
            }
            else {
                this.translate.currentLang === 'en' || this.translate.currentLang === 'en-US'
                    ? (this.announceMaxCharaterLimitReached = MAX_CHAR_LIMIT_EN)
                    : (this.announceMaxCharaterLimitReached = MAX_CHAR_LIMIT_FR);
            }
        }
        if (this.charLimitStatus !== 'maxLimit') {
            this.isEventActive = false;
        }
    }
    formatCharacterUsedString(currentLength) {
        var formatedString = '';
        var currentLengthString = currentLength.toString();
        if (currentLengthString === '-1' ||
            this.config.charLimit === '' ||
            !this.config.charLimit) {
            return formatedString;
        }
        formatedString = currentLengthString + '/' + this.config.charLimit;
        return formatedString;
    }
    clearvalue() { }
    changeValue(event) {
        this.writeValue(event.target.value);
        this.onTouch();
    }
    writeValue(value) {
        this.onChange(value);
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouch = fn;
    }
    setDisabledState(isDisabled) {
        isDisabled
            ? this.formGroup.get(this.config.id)?.disable()
            : this.formGroup.get(this.config.id)?.enable();
    }
}
TextareaComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: TextareaComponent, deps: [{ token: i1.StandAloneFunctions }, { token: i2.TranslateService }], target: i0.ɵɵFactoryTarget.Component });
TextareaComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.12", type: TextareaComponent, selector: "ircc-cl-lib-textarea", inputs: { config: "config", id: "id", formGroup: "formGroup", size: "size", label: "label", desc: "desc", hint: "hint", placeholder: "placeholder", required: "required", charLimit: "charLimit", resizable: "resizable", errorMessages: "errorMessages", errorIcon: "errorIcon" }, host: { listeners: { "window:keypress": "onKeyPress($event)" } }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => TextareaComponent),
            multi: true
        }
    ], usesOnChanges: true, ngImport: i0, template: "<div>\n  <form [formGroup]=\"config.formGroup\">\n    <div\n      class=\"textarea-container\"\n      ngClass=\"{{ config.size }} resize-{{ config.resizable }}\"\n    >\n      <div>\n        <ircc-cl-lib-label\n          [config]=\"labelConfig\"\n          [attr.size]=\"config.size\"\n        ></ircc-cl-lib-label>\n        <div\n          class=\"content-area\"\n          [ngClass]=\"focusState === true ? 'focus' : ''\"\n        >\n          <textarea\n            class=\"textarea-field\"\n            maxlength=\"{{ config.charLimit }}\"\n            placeholder=\"{{\n              announceCharStatusChangeAria\n                ? ''\n                : (config.placeholder || '' | translate)\n            }}\"\n            [id]=\"config.id\"\n            tabindex=\"0\"\n            (blur)=\"onBlur()\"\n            (change)=\"changeValue($event)\"\n            [formControlName]=\"config.id\"\n            [attr.aria-label]=\"\n              announceCharStatusChangeAria\n                ? currentCharacterStatusAria\n                : (config.label || '' | translate) +\n                  ' ' +\n                  (config.desc || '' | translate) +\n                  ' ' +\n                  (config.hint || '' | translate) +\n                  ' ' +\n                  (config.placeholder || '' | translate) +\n                  ' ' +\n                  formatCharacterUsedString(charLength)\n            \"\n            #textareaInput\n          >\n          </textarea>\n          <p\n            *ngIf=\"config.charLimit\"\n            class=\"character-count\"\n            [ngClass]=\"charLimitStatus\"\n          >\n            {{ textareaInput.value.length }}/{{ config.charLimit }}\n          </p>\n          <span\n            class=\"sr-only\"\n            aria-live=\"polite\"\n            [innerHTML]=\"announceMaxCharaterLimitReached\"\n          >\n          </span>\n        </div>\n      </div>\n\n      <div\n        *ngIf=\"\n          config.formGroup.get(config.id)?.touched &&\n          config.formGroup.get(config.id)?.invalid\n        \"\n        class=\"check-error\"\n      >\n        <ng-container *ngFor=\"let errors of errorIds; let i = index\">\n          <div\n            *ngIf=\"config.formGroup.get(config.id)?.errors?.[errors.key]\"\n            class=\"radio-errors\"\n          >\n            <ircc-cl-lib-error\n              [size]=\"config.size\"\n              [id]=\"errors.id\"\n              [errorLOV]=\"errors.errorLOV\"\n            ></ircc-cl-lib-error>\n          </div>\n        </ng-container>\n      </div>\n    </div>\n  </form>\n</div>\n", dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: i4.LabelComponent, selector: "ircc-cl-lib-label", inputs: ["config", "formGroup", "errorMessages", "parentID", "label", "desc", "hint", "required", "iconButton", "topLabel", "touched", "legend"] }, { kind: "directive", type: i5.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i5.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i5.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i5.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i5.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }, { kind: "directive", type: i5.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i5.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "component", type: i6.ErrorComponent, selector: "ircc-cl-lib-error", inputs: ["config", "id", "errorLOV", "icon", "size"] }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }], preserveWhitespaces: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: TextareaComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ircc-cl-lib-textarea', providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => TextareaComponent),
                            multi: true
                        }
                    ], template: "<div>\n  <form [formGroup]=\"config.formGroup\">\n    <div\n      class=\"textarea-container\"\n      ngClass=\"{{ config.size }} resize-{{ config.resizable }}\"\n    >\n      <div>\n        <ircc-cl-lib-label\n          [config]=\"labelConfig\"\n          [attr.size]=\"config.size\"\n        ></ircc-cl-lib-label>\n        <div\n          class=\"content-area\"\n          [ngClass]=\"focusState === true ? 'focus' : ''\"\n        >\n          <textarea\n            class=\"textarea-field\"\n            maxlength=\"{{ config.charLimit }}\"\n            placeholder=\"{{\n              announceCharStatusChangeAria\n                ? ''\n                : (config.placeholder || '' | translate)\n            }}\"\n            [id]=\"config.id\"\n            tabindex=\"0\"\n            (blur)=\"onBlur()\"\n            (change)=\"changeValue($event)\"\n            [formControlName]=\"config.id\"\n            [attr.aria-label]=\"\n              announceCharStatusChangeAria\n                ? currentCharacterStatusAria\n                : (config.label || '' | translate) +\n                  ' ' +\n                  (config.desc || '' | translate) +\n                  ' ' +\n                  (config.hint || '' | translate) +\n                  ' ' +\n                  (config.placeholder || '' | translate) +\n                  ' ' +\n                  formatCharacterUsedString(charLength)\n            \"\n            #textareaInput\n          >\n          </textarea>\n          <p\n            *ngIf=\"config.charLimit\"\n            class=\"character-count\"\n            [ngClass]=\"charLimitStatus\"\n          >\n            {{ textareaInput.value.length }}/{{ config.charLimit }}\n          </p>\n          <span\n            class=\"sr-only\"\n            aria-live=\"polite\"\n            [innerHTML]=\"announceMaxCharaterLimitReached\"\n          >\n          </span>\n        </div>\n      </div>\n\n      <div\n        *ngIf=\"\n          config.formGroup.get(config.id)?.touched &&\n          config.formGroup.get(config.id)?.invalid\n        \"\n        class=\"check-error\"\n      >\n        <ng-container *ngFor=\"let errors of errorIds; let i = index\">\n          <div\n            *ngIf=\"config.formGroup.get(config.id)?.errors?.[errors.key]\"\n            class=\"radio-errors\"\n          >\n            <ircc-cl-lib-error\n              [size]=\"config.size\"\n              [id]=\"errors.id\"\n              [errorLOV]=\"errors.errorLOV\"\n            ></ircc-cl-lib-error>\n          </div>\n        </ng-container>\n      </div>\n    </div>\n  </form>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i1.StandAloneFunctions }, { type: i2.TranslateService }]; }, propDecorators: { config: [{
                type: Input
            }], id: [{
                type: Input
            }], formGroup: [{
                type: Input
            }], size: [{
                type: Input
            }], label: [{
                type: Input
            }], desc: [{
                type: Input
            }], hint: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], required: [{
                type: Input
            }], charLimit: [{
                type: Input
            }], resizable: [{
                type: Input
            }], errorMessages: [{
                type: Input
            }], errorIcon: [{
                type: Input
            }], onKeyPress: [{
                type: HostListener,
                args: ['window:keypress', ['$event']]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dGFyZWEuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vY29tcG9uZW50LWxpYi9zcmMvbGliL2Zvcm0tY29tcG9uZW50cy90ZXh0YXJlYS90ZXh0YXJlYS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9jb21wb25lbnQtbGliL3NyYy9saWIvZm9ybS1jb21wb25lbnRzL3RleHRhcmVhL3RleHRhcmVhLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWMsVUFBVSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQWdDLE1BQU0sZUFBZSxDQUFDO0FBQ3JILE9BQU8sRUFHTCxTQUFTLEVBQ1QsaUJBQWlCLEVBQ2xCLE1BQU0sZ0JBQWdCLENBQUM7Ozs7Ozs7O0FBY3hCLE1BQU0sQ0FBQyxNQUFNLGlCQUFpQixHQUFHLGtDQUFrQyxDQUFDO0FBQ3BFLE1BQU0sQ0FBQyxNQUFNLGlCQUFpQixHQUFHLHlDQUF5QyxDQUFDO0FBRTNFLE1BQU0sQ0FBQyxNQUFNLHFCQUFxQixHQUNoQyxtREFBbUQsQ0FBQztBQUN0RCxNQUFNLENBQUMsTUFBTSxxQkFBcUIsR0FDaEMsMERBQTBELENBQUM7QUFrQjdELE1BQU0sQ0FBTixJQUFZLGNBS1g7QUFMRCxXQUFZLGNBQWM7SUFDeEIsdUNBQXFCLENBQUE7SUFDckIseUNBQXVCLENBQUE7SUFDdkIsK0JBQWEsQ0FBQTtJQUNiLCtCQUFhLENBQUE7QUFDZixDQUFDLEVBTFcsY0FBYyxLQUFkLGNBQWMsUUFLekI7QUFZRCxNQUFNLE9BQU8saUJBQWlCO0lBb0M1QixZQUNTLG1CQUF3QyxFQUN2QyxTQUEyQjtRQUQ1Qix3QkFBbUIsR0FBbkIsbUJBQW1CLENBQXFCO1FBQ3ZDLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBckNyQyxtQkFBYyxHQUFjLElBQUksU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FB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U0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDO0lBQ25ELENBQUM7OytHQTdPVSxpQkFBaUI7bUdBQWpCLGlCQUFpQixxWUFSakI7UUFDVDtZQUNFLE9BQU8sRUFBRSxpQkFBaUI7WUFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztZQUNoRCxLQUFLLEVBQUUsSUFBSTtTQUNaO0tBQ0YsK0NDM0RILDBpRkFtRkE7NEZEdEJhLGlCQUFpQjtrQkFYN0IsU0FBUzsrQkFDRSxzQkFBc0IsYUFFckI7d0JBQ1Q7NEJBQ0UsT0FBTyxFQUFFLGlCQUFpQjs0QkFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsa0JBQWtCLENBQUM7NEJBQ2hELEtBQUssRUFBRSxJQUFJO3lCQUNaO3FCQUNGO3lJQUtRLE1BQU07c0JBQWQsS0FBSztnQkFLRyxFQUFFO3NCQUFWLEtBQUs7Z0JBQ0csU0FBUztzQkFBakIsS0FBSztnQkFDRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csS0FBSztzQkFBYixLQUFLO2dCQUNHLElBQUk7c0JBQVosS0FBSztnQkFDRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csU0FBUztzQkFBakIsS0FBSztnQkFDRyxhQUFhO3NCQUFyQixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBeUtOLFVBQVU7c0JBRFQsWUFBWTt1QkFBQyxpQkFBaUIsRUFBRSxDQUFDLFFBQVEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRWxlbWVudFJlZiwgZm9yd2FyZFJlZiwgSG9zdExpc3RlbmVyLCBJbnB1dCwgT25Jbml0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgQ29udHJvbFZhbHVlQWNjZXNzb3IsXG4gIEZvcm1Db250cm9sU3RhdHVzLFxuICBGb3JtR3JvdXAsXG4gIE5HX1ZBTFVFX0FDQ0VTU09SXG59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IERTU2l6ZXMgfSBmcm9tICcuLi8uLi8uLi9zaGFyZWQvY29uc3RhbnRzL2psLWNvbXBvbmVudHMuY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIElFcnJvcklEcyxcbiAgU3RhbmRBbG9uZUZ1bmN0aW9uc1xufSBmcm9tICcuLi8uLi8uLi9zaGFyZWQvZnVuY3Rpb25zL3N0YW5kLWFsb25lLmZ1bmN0aW9ucyc7XG5pbXBvcnQgeyBJRXJyb3JQYWlycyB9IGZyb20gJy4uLy4uLy4uL3NoYXJlZC9pbnRlcmZhY2VzL2NvbXBvbmVudC1jb25maWdzJztcbmltcG9ydCB7XG4gIElMYWJlbENvbmZpZyxcbiAgSUxhYmVsSWNvbkNvbmZpZ1xufSBmcm9tICcuLi8uLi9zaGFyZWQvbGFiZWwvbGFiZWwuY29tcG9uZW50JztcbmltcG9ydCB7IElFcnJvckljb25Db25maWcgfSBmcm9tICcuLi9lcnJvci9lcnJvci5jb21wb25lbnQnO1xuaW1wb3J0IHsgVHJhbnNsYXRlU2VydmljZSB9IGZyb20gJ0BuZ3gtdHJhbnNsYXRlL2NvcmUnO1xuXG5leHBvcnQgY29uc3QgTUFYX0NIQVJfTElNSVRfRU4gPSAnTWF4aW11bSBjaGFyYWN0ZXIgbGltaXQgcmVhY2hlZC4nO1xuZXhwb3J0IGNvbnN0IE1BWF9DSEFSX0xJTUlUX0ZSID0gJ0xpbWl0ZSBtYXhpbWFsZSBkZSBjYXJhY3TDqHJlcyBhdHRlaW50ZS4nO1xuXG5leHBvcnQgY29uc3QgV0FSTklOR19DSEFSX0xJTUlUX0VOID1cbiAgJ01heGltdW0gY2hhcmFjdGVyIGxpbWl0IHJlYWNoZWQgaW4gMTUgY2hhcmFjdGVycy4nO1xuZXhwb3J0IGNvbnN0IFdBUk5JTkdfQ0hBUl9MSU1JVF9GUiA9XG4gICdMaW1pdGUgbWF4aW1hbGUgZGUgY2FyYWN0w6hyZXMgYXR0ZWludGUgZW4gMTUgY2FyYWN0w6hyZXMuJztcblxuZXhwb3J0IGludGVyZmFjZSBJVGV4dGFyZWFDb21wb25lbnRDb25maWcge1xuICBmb3JtR3JvdXA6IEZvcm1Hcm91cDtcbiAgaWQ6IHN0cmluZztcbiAgbGFiZWw/OiBzdHJpbmc7XG4gIGRlc2M/OiBzdHJpbmc7XG4gIGhpbnQ/OiBzdHJpbmc7XG4gIHJlcXVpcmVkPzogYm9vbGVhbjsgLy8gVGhpcyBmaWVsZCBvbmx5IGFkZHMgc3R5bGluZyB0byB0aGUgbGFiZWwgYW5kIERPRVMgTk9UIGFkZCBhbnkgdmFsaWRhdGlvbiB0byB0aGUgaW5wdXQgZmllbGQuXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICBjaGFyTGltaXQ/OiBzdHJpbmc7XG4gIHJlc2l6YWJsZT86IGtleW9mIHR5cGVvZiBSZXNpemFibGVUeXBlcztcbiAgc2l6ZT86IGtleW9mIHR5cGVvZiBEU1NpemVzO1xuICBlcnJvck1lc3NhZ2VzPzogSUVycm9yUGFpcnNbXTtcbiAgZXJyb3JJY29uPzogSUVycm9ySWNvbkNvbmZpZztcbiAgbGFiZWxJY29uQ29uZmlnPzogSUxhYmVsSWNvbkNvbmZpZztcbn1cblxuZXhwb3J0IGVudW0gUmVzaXphYmxlVHlwZXMge1xuICB2ZXJ0aWNhbCA9ICd2ZXJ0aWNhbCcsXG4gIGhvcml6b250YWwgPSAncGFzc3dvcmQnLFxuICBib3RoID0gJ2JvdGgnLFxuICBub25lID0gJ25vbmUnXG59XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdpcmNjLWNsLWxpYi10ZXh0YXJlYScsXG4gIHRlbXBsYXRlVXJsOiAnLi90ZXh0YXJlYS5jb21wb25lbnQuaHRtbCcsXG4gIHByb3ZpZGVyczogW1xuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVGV4dGFyZWFDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgVGV4dGFyZWFDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25Jbml0IHtcbiAgZm9ybUdyb3VwRW1wdHk6IEZvcm1Hcm91cCA9IG5ldyBGb3JtR3JvdXAoe30pO1xuICAvL0RPTidUIGluY2x1ZGUgZGVmYXVsdCB2YWx1ZXMgb2YgJycgdW5sZXNzIGl0IFJFQUxMWSBtYWtlcyBzZW5zZSB0byBkbyBzby4gSW5zdGVhZCwgbWFrZSB0aGVtIG9wdGlvbmFsXG4gIEBJbnB1dCgpIGNvbmZpZzogSVRleHRhcmVhQ29tcG9uZW50Q29uZmlnID0ge1xuICAgIGlkOiAnJyxcbiAgICBmb3JtR3JvdXA6IG5ldyBGb3JtR3JvdXAoe30pXG4gIH07XG5cbiAgQElucHV0KCkgaWQgPSAnJztcbiAgQElucHV0KCkgZm9ybUdyb3VwID0gdGhpcy5mb3JtR3JvdXBFbXB0eTtcbiAgQElucHV0KCkgc2l6ZT86IGtleW9mIHR5cGVvZiBEU1NpemVzO1xuICBASW5wdXQoKSBsYWJlbD86IHN0cmluZztcbiAgQElucHV0KCkgZGVzYz86IHN0cmluZztcbiAgQElucHV0KCkgaGludD86IHN0cmluZztcbiAgQElucHV0KCkgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIEBJbnB1dCgpIHJlcXVpcmVkPzogYm9vbGVhbjsgLy8gVGhpcyBmaWVsZCBvbmx5IGFkZHMgc3R5bGluZyB0byB0aGUgbGFiZWwgYW5kIERPRVMgTk9UIGFkZCBhbnkgdmFsaWRhdGlvbiB0byB0aGUgaW5wdXQgZmllbGQuXG4gIEBJbnB1dCgpIGNoYXJMaW1pdCA9ICcnO1xuICBASW5wdXQoKSByZXNpemFibGU/OiBrZXlvZiB0eXBlb2YgUmVzaXphYmxlVHlwZXM7XG4gIEBJbnB1dCgpIGVycm9yTWVzc2FnZXM/OiBJRXJyb3JQYWlyc1tdO1xuICBASW5wdXQoKSBlcnJvckljb24/OiBJRXJyb3JJY29uQ29uZmlnO1xuXG4gIGRpc2FibGVkID0gZmFsc2U7XG4gIGZvY3VzU3RhdGUgPSBmYWxzZTtcbiAgZXJyb3JJZHM6IElFcnJvcklEc1tdID0gW107XG4gIGNoYXJMaW1pdFN0YXR1cyA9ICcnO1xuICBjdXJyZW50Q2hhcmFjdGVyU3RhdHVzQXJpYSA9ICcnO1xuICBjdXJyZW50U3RhdHVzOiBGb3JtQ29udHJvbFN0YXR1cyA9ICdWQUxJRCc7XG4gIGFubm91bmNlQ2hhclN0YXR1c0NoYW5nZUFyaWE6IGJvb2xlYW4gPSBmYWxzZTtcbiAgY2hhckxlbmd0aDogbnVtYmVyID0gLTE7XG4gIGxhYmVsQ29uZmlnOiBJTGFiZWxDb25maWcgPSB7XG4gICAgZm9ybUdyb3VwOiB0aGlzLmNvbmZpZy5mb3JtR3JvdXAsXG4gICAgcGFyZW50SUQ6ICcnXG4gIH07XG4gIGlzRXZlbnRBY3RpdmUgPSBmYWxzZTtcbiAgYW5ub3VuY2VNYXhDaGFyYXRlckxpbWl0UmVhY2hlZCA9ICcnXG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHN0YW5kQWxvbmVGdW5jdGlvbnM6IFN0YW5kQWxvbmVGdW5jdGlvbnMsXG4gICAgcHJpdmF0ZSB0cmFuc2xhdGU6IFRyYW5zbGF0ZVNlcnZpY2VcbiAgKSB7fVxuXG4gIC8vUmVtb3ZlZCAnIScgYW5kIGFkZGVkIG51bGwgY2FzZSBpbiBvbkNoYW5nZVxuICBvblRvdWNoID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLmNvbmZpZy5mb3JtR3JvdXA/LmdldCh0aGlzLmNvbmZpZy5pZCk/LnRvdWNoZWQgPT09IGZhbHNlKSB7XG4gICAgICB0aGlzLmNvbmZpZy5mb3JtR3JvdXA/LmdldCh0aGlzLmNvbmZpZy5pZCk/Lm1hcmtBc1RvdWNoZWQoKTtcbiAgICB9XG4gIH07XG4gIG9uQ2hhbmdlID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICB0aGlzLmNvbmZpZy5mb3JtR3JvdXAuZ2V0KHRoaXMuY29uZmlnLmlkKT8uc2V0VmFsdWUodmFsdWUpO1xuICB9O1xuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIC8vc2V0IGNvbmZpZyBmcm9tIGluZGl2aWR1YWwgb3B0aW9ucywgaWYgcHJlc2VudFxuICAgIGlmICh0aGlzLmlkICE9PSAnJykgdGhpcy5jb25maWcuaWQgPSB0aGlzLmlkO1xuICAgIGlmICh0aGlzLmZvcm1Hcm91cCAhPT0gdGhpcy5mb3JtR3JvdXBFbXB0eSlcbiAgICAgIHRoaXMuY29uZmlnLmZvcm1Hcm91cCA9IHRoaXMuZm9ybUdyb3VwO1xuICAgIGlmICh0aGlzLmNoYXJMaW1pdCAhPT0gJycpIHRoaXMuY29uZmlnLmNoYXJMaW1pdCA9IHRoaXMuY2hhckxpbWl0O1xuICAgIGlmICh0aGlzLnNpemUpIHRoaXMuY29uZmlnLnNpemUgPSB0aGlzLnNpemU7XG4gICAgaWYgKHRoaXMubGFiZWwpIHRoaXMuY29uZmlnLmxhYmVsID0gdGhpcy5sYWJlbDtcbiAgICBpZiAodGhpcy5kZXNjKSB0aGlzLmNvbmZpZy5kZXNjID0gdGhpcy5kZXNjO1xuICAgIGlmICh0aGlzLmhpbnQpIHRoaXMuY29uZmlnLmhpbnQgPSB0aGlzLmhpbnQ7XG4gICAgaWYgKHRoaXMucGxhY2Vob2xkZXIpIHRoaXMuY29uZmlnLnBsYWNlaG9sZGVyID0gdGhpcy5wbGFjZWhvbGRlcjtcbiAgICBpZiAodGhpcy5yZXF1aXJlZCkgdGhpcy5jb25maWcucmVxdWlyZWQgPSB0aGlzLnJlcXVpcmVkO1xuICAgIGlmICh0aGlzLnJlc2l6YWJsZSkgdGhpcy5jb25maWcucmVzaXphYmxlID0gdGhpcy5yZXNpemFibGU7XG4gICAgaWYgKHRoaXMuZXJyb3JNZXNzYWdlcykgdGhpcy5jb25maWcuZXJyb3JNZXNzYWdlcyA9IHRoaXMuZXJyb3JNZXNzYWdlcztcbiAgICBpZiAodGhpcy5lcnJvckljb24pIHRoaXMuY29uZmlnLmVycm9ySWNvbiA9IHRoaXMuZXJyb3JJY29uO1xuXG4gICAgaWYgKHRoaXMuY29uZmlnLmNoYXJMaW1pdCAhPSAnJyAmJiB0aGlzLmNvbmZpZy5jaGFyTGltaXQpIHtcbiAgICAgIHRoaXMuY2hhckxlbmd0aCA9IDA7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29uZmlnLmVycm9yTWVzc2FnZXMpIHtcbiAgICAgIHRoaXMuZXJyb3JJZHMgPSB0aGlzLnN0YW5kQWxvbmVGdW5jdGlvbnMuZ2V0RXJyb3JJZHMoXG4gICAgICAgIHRoaXMuY29uZmlnLmZvcm1Hcm91cCxcbiAgICAgICAgdGhpcy5jb25maWcuaWQsXG4gICAgICAgIHRoaXMuY29uZmlnLmVycm9yTWVzc2FnZXNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29uZmlnLmZvcm1Hcm91cC5jb250cm9sc1t0aGlzLmNvbmZpZy5pZF0udmFsdWUpIHtcbiAgICAgIHRoaXMuY2hhckxlbmd0aCA9XG4gICAgICAgIHRoaXMuY29uZmlnLmZvcm1Hcm91cC5jb250cm9sc1t0aGlzLmNvbmZpZy5pZF0udmFsdWUubGVuZ3RoO1xuICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudFN0YXR1cyhcbiAgICAgICAgdGhpcy5jb25maWcuZm9ybUdyb3VwLmNvbnRyb2xzW3RoaXMuY29uZmlnLmlkXS52YWx1ZS5sZW5ndGhcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhpcy5jb25maWcuZm9ybUdyb3VwLnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUoKGNoYW5nZSkgPT4ge1xuICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudFN0YXR1cyhjaGFuZ2VbdGhpcy5jb25maWcuaWRdPy5sZW5ndGgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5sYWJlbENvbmZpZyA9IHRoaXMuc3RhbmRBbG9uZUZ1bmN0aW9ucy5tYWtlTGFiZWxDb25maWcoXG4gICAgICB0aGlzLmNvbmZpZy5mb3JtR3JvdXAsXG4gICAgICB0aGlzLmNvbmZpZy5pZCxcbiAgICAgIHRoaXMuY29uZmlnLmVycm9yTWVzc2FnZXMsXG4gICAgICB0aGlzLmNvbmZpZy5sYWJlbCxcbiAgICAgIHRoaXMuY29uZmlnLmRlc2MsXG4gICAgICB0aGlzLmNvbmZpZy5oaW50LFxuICAgICAgdGhpcy5jb25maWcucmVxdWlyZWQsXG4gICAgICB0aGlzLmNvbmZpZy5sYWJlbEljb25Db25maWdcbiAgICApO1xuXG4gICAgdGhpcy5jdXJyZW50U3RhdHVzID1cbiAgICAgIHRoaXMuY29uZmlnLmZvcm1Hcm91cC5nZXQodGhpcy5jb25maWcuaWQpPy5zdGF0dXMgfHwgJ0RJU0FCTEVEJztcbiAgICB0aGlzLnRvZ2dsZURpc2FibGVkU3RhdGUoKTtcbiAgICB0aGlzLmNvbmZpZy5mb3JtR3JvdXBcbiAgICAgIC5nZXQodGhpcy5jb25maWcuaWQpXG4gICAgICA/LnN0YXR1c0NoYW5nZXMuc3Vic2NyaWJlKChjaGFuZ2UpID0+IHtcbiAgICAgICAgaWYgKGNoYW5nZSAhPT0gdGhpcy5jdXJyZW50U3RhdHVzKSB7XG4gICAgICAgICAgdGhpcy5jdXJyZW50U3RhdHVzID0gY2hhbmdlO1xuICAgICAgICAgIHRoaXMudG9nZ2xlRGlzYWJsZWRTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nID09PSAnZW4nIHx8IHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nID09PSAnZW4tVVMnXG4gICAgICA/ICh0aGlzLmFubm91bmNlTWF4Q2hhcmF0ZXJMaW1pdFJlYWNoZWQgPSBNQVhfQ0hBUl9MSU1JVF9FTilcbiAgICAgIDogKHRoaXMuYW5ub3VuY2VNYXhDaGFyYXRlckxpbWl0UmVhY2hlZCA9IE1BWF9DSEFSX0xJTUlUX0ZSKTtcbiAgfVxuXG4gIHRvZ2dsZURpc2FibGVkU3RhdGUoKSB7XG4gICAgc3dpdGNoICh0aGlzLmN1cnJlbnRTdGF0dXMpIHtcbiAgICAgIGNhc2UgJ0RJU0FCTEVEJzpcbiAgICAgICAgdGhpcy5zZXREaXNhYmxlZFN0YXRlKHRydWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRoaXMuc2V0RGlzYWJsZWRTdGF0ZShmYWxzZSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIHRoaXMubGFiZWxDb25maWcgPSB0aGlzLnN0YW5kQWxvbmVGdW5jdGlvbnMubWFrZUxhYmVsQ29uZmlnKFxuICAgICAgdGhpcy5jb25maWcuZm9ybUdyb3VwLFxuICAgICAgdGhpcy5jb25maWcuaWQsXG4gICAgICB0aGlzLmNvbmZpZy5lcnJvck1lc3NhZ2VzLFxuICAgICAgdGhpcy5jb25maWcubGFiZWwsXG4gICAgICB0aGlzLmNvbmZpZy5kZXNjLFxuICAgICAgdGhpcy5jb25maWcuaGludCxcbiAgICAgIHRoaXMuY29uZmlnLnJlcXVpcmVkLFxuICAgICAgdGhpcy5jb25maWcubGFiZWxJY29uQ29uZmlnXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBmb2N1c0lucHV0KGZvY3VzVmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmZvY3VzU3RhdGUgPSAhZm9jdXNWYWx1ZTtcbiAgfVxuXG4gIGNoYXJhY3RlckNvdW50U3RhdHVzKGN1cnJDaGFyQ291bnQ6IGFueSkge1xuICAgIGxldCBjdXJyTGFuZyA9IHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nO1xuICAgIGlmICh0aGlzLmNvbmZpZz8uY2hhckxpbWl0KSB7XG4gICAgICBpZiAodGhpcy5jb25maWc/LmNoYXJMaW1pdCA9PSBjdXJyQ2hhckNvdW50KSB7XG4gICAgICAgIHRoaXMuY2hhckxpbWl0U3RhdHVzID0gJ21heExpbWl0JztcbiAgICAgICAgY3VyckxhbmcgPT09ICdlbicgfHwgY3VyckxhbmcgPT09ICdlbi1VUydcbiAgICAgICAgICA/ICh0aGlzLmN1cnJlbnRDaGFyYWN0ZXJTdGF0dXNBcmlhID0gTUFYX0NIQVJfTElNSVRfRU4pXG4gICAgICAgICAgOiAodGhpcy5jdXJyZW50Q2hhcmFjdGVyU3RhdHVzQXJpYSA9IE1BWF9DSEFSX0xJTUlUX0ZSKTtcbiAgICAgICAgdGhpcy5hbm5vdW5jZUNoYXJTdGF0dXNDaGFuZ2VBcmlhID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pc0V2ZW50QWN0aXZlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAoTnVtYmVyKHRoaXMuY29uZmlnPy5jaGFyTGltaXQpIC0gY3VyckNoYXJDb3VudCA9PSAxNSkge1xuICAgICAgICB0aGlzLmNoYXJMaW1pdFN0YXR1cyA9ICd3YXJuaW5nTGltaXQnO1xuICAgICAgICBjdXJyTGFuZyA9PT0gJ2VuJyB8fCBjdXJyTGFuZyA9PT0gJ2VuLVVTJ1xuICAgICAgICAgID8gKHRoaXMuY3VycmVudENoYXJhY3RlclN0YXR1c0FyaWEgPSBXQVJOSU5HX0NIQVJfTElNSVRfRU4pXG4gICAgICAgICAgOiAodGhpcy5jdXJyZW50Q2hhcmFjdGVyU3RhdHVzQXJpYSA9IFdBUk5JTkdfQ0hBUl9MSU1JVF9GUik7XG4gICAgICAgIHRoaXMuYW5ub3VuY2VDaGFyU3RhdHVzQ2hhbmdlQXJpYSA9IHRydWU7XG4gICAgICAgIHRoaXMuaXNFdmVudEFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChOdW1iZXIodGhpcy5jb25maWc/LmNoYXJMaW1pdCkgLSBjdXJyQ2hhckNvdW50IDwgMTUpIHtcbiAgICAgICAgdGhpcy5jaGFyTGltaXRTdGF0dXMgPSAnd2FybmluZ0xpbWl0JztcbiAgICAgICAgdGhpcy5jdXJyZW50Q2hhcmFjdGVyU3RhdHVzQXJpYSA9ICcnO1xuICAgICAgICB0aGlzLmlzRXZlbnRBY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2hhckxpbWl0U3RhdHVzID0gJyc7XG4gICAgICAgIHRoaXMuY3VycmVudENoYXJhY3RlclN0YXR1c0FyaWEgPSAnJztcbiAgICAgICAgdGhpcy5pc0V2ZW50QWN0aXZlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25CbHVyKCkge1xuICAgIHRoaXMuYW5ub3VuY2VDaGFyU3RhdHVzQ2hhbmdlQXJpYSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmNvbmZpZy5mb3JtR3JvdXAuY29udHJvbHNbdGhpcy5jb25maWcuaWRdLnZhbHVlKSB7XG4gICAgICB0aGlzLmNoYXJMZW5ndGggPVxuICAgICAgICB0aGlzLmNvbmZpZy5mb3JtR3JvdXAuY29udHJvbHNbdGhpcy5jb25maWcuaWRdLnZhbHVlLmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jaGFyTGVuZ3RoID0gMDtcbiAgICB9XG4gIH1cblxuICAvL0tlZXAgYW5ub3VuY2luZyBtYXggY2hhciBsaW1pdCByZWFjaGVkIGZvciBlYWNoIGtleXByZXNzIG1hZGUgYWZ0ZXIgbWF4IGxpbWl0IGhhcyByZWFjaGVkXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXlwcmVzcycsIFsnJGV2ZW50J10pXG4gIG9uS2V5UHJlc3MoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICBpZiAodGhpcy5pc0V2ZW50QWN0aXZlKSB7XG4gICAgICBpZih0aGlzLmFubm91bmNlTWF4Q2hhcmF0ZXJMaW1pdFJlYWNoZWQgPT09IE1BWF9DSEFSX0xJTUlUX0VOIHx8IHRoaXMuYW5ub3VuY2VNYXhDaGFyYXRlckxpbWl0UmVhY2hlZCA9PT0gTUFYX0NIQVJfTElNSVRfRlIpIHtcbiAgICAgICAgdGhpcy5hbm5vdW5jZU1heENoYXJhdGVyTGltaXRSZWFjaGVkKz0nJm5ic3A7J1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nID09PSAnZW4nIHx8IHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nID09PSAnZW4tVVMnXG4gICAgICAgICAgPyAodGhpcy5hbm5vdW5jZU1heENoYXJhdGVyTGltaXRSZWFjaGVkID0gTUFYX0NIQVJfTElNSVRfRU4pXG4gICAgICAgICAgOiAodGhpcy5hbm5vdW5jZU1heENoYXJhdGVyTGltaXRSZWFjaGVkID0gTUFYX0NIQVJfTElNSVRfRlIpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5jaGFyTGltaXRTdGF0dXMgIT09ICdtYXhMaW1pdCcpIHtcbiAgICAgIHRoaXMuaXNFdmVudEFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGZvcm1hdENoYXJhY3RlclVzZWRTdHJpbmcoY3VycmVudExlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICB2YXIgZm9ybWF0ZWRTdHJpbmcgPSAnJztcbiAgICB2YXIgY3VycmVudExlbmd0aFN0cmluZyA9IGN1cnJlbnRMZW5ndGgudG9TdHJpbmcoKTtcbiAgICBpZiAoXG4gICAgICBjdXJyZW50TGVuZ3RoU3RyaW5nID09PSAnLTEnIHx8XG4gICAgICB0aGlzLmNvbmZpZy5jaGFyTGltaXQgPT09ICcnIHx8XG4gICAgICAhdGhpcy5jb25maWcuY2hhckxpbWl0XG4gICAgKSB7XG4gICAgICByZXR1cm4gZm9ybWF0ZWRTdHJpbmc7XG4gICAgfVxuICAgIGZvcm1hdGVkU3RyaW5nID0gY3VycmVudExlbmd0aFN0cmluZyArICcvJyArIHRoaXMuY29uZmlnLmNoYXJMaW1pdDtcbiAgICByZXR1cm4gZm9ybWF0ZWRTdHJpbmc7XG4gIH1cblxuICBwdWJsaWMgY2xlYXJ2YWx1ZSgpIHt9XG5cbiAgY2hhbmdlVmFsdWUoZXZlbnQ6IGFueSkge1xuICAgIHRoaXMud3JpdGVWYWx1ZShldmVudC50YXJnZXQudmFsdWUpO1xuICAgIHRoaXMub25Ub3VjaCgpO1xuICB9XG4gIHdyaXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UodmFsdWUpO1xuICB9XG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoID0gZm47XG4gIH1cbiAgc2V0RGlzYWJsZWRTdGF0ZShpc0Rpc2FibGVkOiBib29sZWFuKSB7XG4gICAgaXNEaXNhYmxlZFxuICAgICAgPyB0aGlzLmZvcm1Hcm91cC5nZXQodGhpcy5jb25maWcuaWQpPy5kaXNhYmxlKClcbiAgICAgIDogdGhpcy5mb3JtR3JvdXAuZ2V0KHRoaXMuY29uZmlnLmlkKT8uZW5hYmxlKCk7XG4gIH1cbn1cbiIsIjxkaXY+XG4gIDxmb3JtIFtmb3JtR3JvdXBdPVwiY29uZmlnLmZvcm1Hcm91cFwiPlxuICAgIDxkaXZcbiAgICAgIGNsYXNzPVwidGV4dGFyZWEtY29udGFpbmVyXCJcbiAgICAgIG5nQ2xhc3M9XCJ7eyBjb25maWcuc2l6ZSB9fSByZXNpemUte3sgY29uZmlnLnJlc2l6YWJsZSB9fVwiXG4gICAgPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGlyY2MtY2wtbGliLWxhYmVsXG4gICAgICAgICAgW2NvbmZpZ109XCJsYWJlbENvbmZpZ1wiXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgID48L2lyY2MtY2wtbGliLWxhYmVsPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgY2xhc3M9XCJjb250ZW50LWFyZWFcIlxuICAgICAgICAgIFtuZ0NsYXNzXT1cImZvY3VzU3RhdGUgPT09IHRydWUgPyAnZm9jdXMnIDogJydcIlxuICAgICAgICA+XG4gICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICBjbGFzcz1cInRleHRhcmVhLWZpZWxkXCJcbiAgICAgICAgICAgIG1heGxlbmd0aD1cInt7IGNvbmZpZy5jaGFyTGltaXQgfX1cIlxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7e1xuICAgICAgICAgICAgICBhbm5vdW5jZUNoYXJTdGF0dXNDaGFuZ2VBcmlhXG4gICAgICAgICAgICAgICAgPyAnJ1xuICAgICAgICAgICAgICAgIDogKGNvbmZpZy5wbGFjZWhvbGRlciB8fCAnJyB8IHRyYW5zbGF0ZSlcbiAgICAgICAgICAgIH19XCJcbiAgICAgICAgICAgIFtpZF09XCJjb25maWcuaWRcIlxuICAgICAgICAgICAgdGFiaW5kZXg9XCIwXCJcbiAgICAgICAgICAgIChibHVyKT1cIm9uQmx1cigpXCJcbiAgICAgICAgICAgIChjaGFuZ2UpPVwiY2hhbmdlVmFsdWUoJGV2ZW50KVwiXG4gICAgICAgICAgICBbZm9ybUNvbnRyb2xOYW1lXT1cImNvbmZpZy5pZFwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIlxuICAgICAgICAgICAgICBhbm5vdW5jZUNoYXJTdGF0dXNDaGFuZ2VBcmlhXG4gICAgICAgICAgICAgICAgPyBjdXJyZW50Q2hhcmFjdGVyU3RhdHVzQXJpYVxuICAgICAgICAgICAgICAgIDogKGNvbmZpZy5sYWJlbCB8fCAnJyB8IHRyYW5zbGF0ZSkgK1xuICAgICAgICAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgICAgICAgIChjb25maWcuZGVzYyB8fCAnJyB8IHRyYW5zbGF0ZSkgK1xuICAgICAgICAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgICAgICAgIChjb25maWcuaGludCB8fCAnJyB8IHRyYW5zbGF0ZSkgK1xuICAgICAgICAgICAgICAgICAgJyAnICtcbiAgICAgICAgICAgICAgICAgIChjb25maWcucGxhY2Vob2xkZXIgfHwgJycgfCB0cmFuc2xhdGUpICtcbiAgICAgICAgICAgICAgICAgICcgJyArXG4gICAgICAgICAgICAgICAgICBmb3JtYXRDaGFyYWN0ZXJVc2VkU3RyaW5nKGNoYXJMZW5ndGgpXG4gICAgICAgICAgICBcIlxuICAgICAgICAgICAgI3RleHRhcmVhSW5wdXRcbiAgICAgICAgICA+XG4gICAgICAgICAgPC90ZXh0YXJlYT5cbiAgICAgICAgICA8cFxuICAgICAgICAgICAgKm5nSWY9XCJjb25maWcuY2hhckxpbWl0XCJcbiAgICAgICAgICAgIGNsYXNzPVwiY2hhcmFjdGVyLWNvdW50XCJcbiAgICAgICAgICAgIFtuZ0NsYXNzXT1cImNoYXJMaW1pdFN0YXR1c1wiXG4gICAgICAgICAgPlxuICAgICAgICAgICAge3sgdGV4dGFyZWFJbnB1dC52YWx1ZS5sZW5ndGggfX0ve3sgY29uZmlnLmNoYXJMaW1pdCB9fVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgY2xhc3M9XCJzci1vbmx5XCJcbiAgICAgICAgICAgIGFyaWEtbGl2ZT1cInBvbGl0ZVwiXG4gICAgICAgICAgICBbaW5uZXJIVE1MXT1cImFubm91bmNlTWF4Q2hhcmF0ZXJMaW1pdFJlYWNoZWRcIlxuICAgICAgICAgID5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXZcbiAgICAgICAgKm5nSWY9XCJcbiAgICAgICAgICBjb25maWcuZm9ybUdyb3VwLmdldChjb25maWcuaWQpPy50b3VjaGVkICYmXG4gICAgICAgICAgY29uZmlnLmZvcm1Hcm91cC5nZXQoY29uZmlnLmlkKT8uaW52YWxpZFxuICAgICAgICBcIlxuICAgICAgICBjbGFzcz1cImNoZWNrLWVycm9yXCJcbiAgICAgID5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgZXJyb3JzIG9mIGVycm9ySWRzOyBsZXQgaSA9IGluZGV4XCI+XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgKm5nSWY9XCJjb25maWcuZm9ybUdyb3VwLmdldChjb25maWcuaWQpPy5lcnJvcnM/LltlcnJvcnMua2V5XVwiXG4gICAgICAgICAgICBjbGFzcz1cInJhZGlvLWVycm9yc1wiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGlyY2MtY2wtbGliLWVycm9yXG4gICAgICAgICAgICAgIFtzaXplXT1cImNvbmZpZy5zaXplXCJcbiAgICAgICAgICAgICAgW2lkXT1cImVycm9ycy5pZFwiXG4gICAgICAgICAgICAgIFtlcnJvckxPVl09XCJlcnJvcnMuZXJyb3JMT1ZcIlxuICAgICAgICAgICAgPjwvaXJjYy1jbC1saWItZXJyb3I+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZm9ybT5cbjwvZGl2PlxuIl19