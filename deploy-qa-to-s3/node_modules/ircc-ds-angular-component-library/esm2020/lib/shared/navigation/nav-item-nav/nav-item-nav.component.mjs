import { Input, ViewChild } from '@angular/core';
import { Component } from '@angular/core';
import { Subscription, filter } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../navigation.service";
import * as i2 from "@angular/common";
import * as i3 from "@angular/router";
import * as i4 from "../../icon/icon.component";
import * as i5 from "../../indicator/indicator.component";
import * as i6 from "@ngx-translate/core";
//TODO: Fix class name (NavItemNavComponent)
export class navItemNavComponent {
    constructor(renderer, navEvent, cdr) {
        this.renderer = renderer;
        this.navEvent = navEvent;
        this.cdr = cdr;
        //TODO: Pattern is supposed to be that any elements that may not be used should be OPTIONAL
        this.config = {
            id: '',
            href: '',
            anchor: '',
            external: false,
            border: false,
            label: '',
            iconLeading: '',
            iconTrailing: '',
            type: 'link',
            children: [],
            header: false
        };
        this.id = '';
        this.indicatorConfig = {
            category: 'weak',
            purpose: 'status',
            type: 'dot',
            tabIndex: -1
        };
        this.headerConfig = {
            iconLeading: '',
            id: 'header_link',
            label: 'Header Title',
            type: 'heading',
            children: []
        };
        // Check if current url's fragment match
        this.fragMatchOptions = {
            queryParams: 'ignored',
            matrixParams: 'exact',
            paths: 'exact',
            fragment: 'exact'
        };
        this.navObjectChangeSub = new Subscription();
    }
    ngOnInit() {
        //Used entirely as a workaround for the change detection limitations
        this.navObjectChangeSub = this.navEvent.itemChangeObs$
            .pipe(filter((item) => item === this.config.id))
            .subscribe(() => {
            this.indicatorConfig.status = this.config.indicator?.status;
            this.indicatorConfig.icon = this.config.indicator?.icon;
        });
        this.id !== '' ? (this.config.id = this.id) : undefined;
        if (this.config.indicator) {
            this.indicatorConfig = {
                type: 'dot',
                category: 'weak',
                purpose: 'status',
                status: this.config.indicator.status,
                icon: this.config.indicator.icon,
                tabIndex: -1
            };
            this.config.indicator.label
                ? (this.indicatorConfig = {
                    ...this.indicatorConfig,
                    type: 'text',
                    label: this.config.indicator.label,
                    tabIndex: -1
                })
                : null;
            this.size
                ? (this.indicatorConfig = { ...this.indicatorConfig, size: this.size })
                : null;
        }
        this.size !== undefined ? (this.config.size = this.size) : undefined;
    }
    linkClick(e) {
        this.navEvent.navEvent({ id: this.config.id, event: e }); //Broadcast the event
        if (!this.config.external) {
            setTimeout(() => {
                if (this.config?.anchor) {
                    const anchorElement = this.renderer.selectRootElement(`#${this.config.anchor}`, true);
                    anchorElement
                        ? anchorElement.scrollIntoView({ behavior: 'smooth' })
                        : null;
                }
            }, 0);
        }
    }
    enterPress(event) {
        if (this.config.external) {
            this.externalLinkA?.nativeElement.click();
        }
        else {
            this.internalLink?.nativeElement.click();
        }
    }
}
navItemNavComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: navItemNavComponent, deps: [{ token: i0.Renderer2 }, { token: i1.NavigationService }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
navItemNavComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.2.12", type: navItemNavComponent, selector: "ircc-cl-lib-nav-item", inputs: { config: "config", id: "id", size: "size", indicator: "indicator" }, viewQueries: [{ propertyName: "externalLinkA", first: true, predicate: ["externalLinkA"], descendants: true }, { propertyName: "internalLink", first: true, predicate: ["internalLink"], descendants: true }], ngImport: i0, template: "<div\n  [id]=\"config.id\"\n  class=\"lib-nav-item\"\n  [ngClass]=\"config?.border ? 'border-left' : null\"\n  (keydown.enter)=\"enterPress($event)\"\n>\n  <div>\n    <ng-container *ngIf=\"config?.external !== true; else externalLink\">\n      <a\n        [routerLink]=\"config?.href || '' | translate\"\n        [fragment]=\"config?.anchor\"\n        [routerLinkActive]=\"'active-link'\"\n        [routerLinkActiveOptions]=\"fragMatchOptions\"\n        (click)=\"linkClick($event)\"\n        #internalLink\n      >\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconLeading\"\n          class=\"icon-left\"\n          [config]=\"{ FA_keywords: config?.iconLeading || '' }\"\n        ></ircc-cl-lib-icon>\n        <p *ngIf=\"config?.header !== true\">\n          {{ config?.label || '' | translate }}\n        </p>\n        <h2\n          *ngIf=\"config?.header === true\"\n          class=\"h5\"\n        >\n          {{ config?.label || '' | translate }}\n        </h2>\n        <!-- <ircc-cl-lib-nav-header\n          [attr.size]=\"config.size\"\n          [size]=\"config.size\"\n          [label]=\"\"\n          *ngIf=\"config?.header === true\"\n        >\n        </ircc-cl-lib-nav-header> -->\n        <ircc-cl-lib-indicator\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.indicator\"\n          [config]=\"indicatorConfig\"\n        ></ircc-cl-lib-indicator>\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconTrailing\"\n          class=\"icon-trailing\"\n          [config]=\"{ FA_keywords: config?.iconTrailing || '' }\"\n        ></ircc-cl-lib-icon>\n      </a>\n    </ng-container>\n    <ng-template #externalLink>\n      <a\n        #externalLinkA\n        target=\"_blank\"\n        [attr.href]=\"\n          config?.href + (config?.anchor ? '#' + config.anchor : '') || ''\n            | translate\n        \"\n      >\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconLeading\"\n          class=\"icon-left\"\n          [config]=\"{ FA_keywords: config?.iconLeading || '' }\"\n        ></ircc-cl-lib-icon>\n        <p>{{ config?.label || '' | translate }} {{ config.size }}</p>\n        <ircc-cl-lib-indicator\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.indicator\"\n          [config]=\"indicatorConfig\"\n        ></ircc-cl-lib-indicator>\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconTrailing\"\n          class=\"icon-trailing\"\n          [config]=\"{ FA_keywords: config?.iconTrailing || '' }\"\n        ></ircc-cl-lib-icon>\n      </a>\n    </ng-template>\n  </div>\n  <div>\n    <ng-content></ng-content>\n  </div>\n</div>\n", dependencies: [{ kind: "directive", type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i3.RouterLinkWithHref, selector: "a[routerLink],area[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i3.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "component", type: i4.IconComponent, selector: "ircc-cl-lib-icon", inputs: ["config", "ariaLabel", "FA_keywords", "size"] }, { kind: "component", type: i5.IndicatorComponent, selector: "ircc-cl-lib-indicator", inputs: ["config", "size", "type", "icon", "category", "purpose", "status", "palette", "ariaLabel", "tabIndex"] }, { kind: "pipe", type: i6.TranslatePipe, name: "translate" }], preserveWhitespaces: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: navItemNavComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ircc-cl-lib-nav-item', template: "<div\n  [id]=\"config.id\"\n  class=\"lib-nav-item\"\n  [ngClass]=\"config?.border ? 'border-left' : null\"\n  (keydown.enter)=\"enterPress($event)\"\n>\n  <div>\n    <ng-container *ngIf=\"config?.external !== true; else externalLink\">\n      <a\n        [routerLink]=\"config?.href || '' | translate\"\n        [fragment]=\"config?.anchor\"\n        [routerLinkActive]=\"'active-link'\"\n        [routerLinkActiveOptions]=\"fragMatchOptions\"\n        (click)=\"linkClick($event)\"\n        #internalLink\n      >\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconLeading\"\n          class=\"icon-left\"\n          [config]=\"{ FA_keywords: config?.iconLeading || '' }\"\n        ></ircc-cl-lib-icon>\n        <p *ngIf=\"config?.header !== true\">\n          {{ config?.label || '' | translate }}\n        </p>\n        <h2\n          *ngIf=\"config?.header === true\"\n          class=\"h5\"\n        >\n          {{ config?.label || '' | translate }}\n        </h2>\n        <!-- <ircc-cl-lib-nav-header\n          [attr.size]=\"config.size\"\n          [size]=\"config.size\"\n          [label]=\"\"\n          *ngIf=\"config?.header === true\"\n        >\n        </ircc-cl-lib-nav-header> -->\n        <ircc-cl-lib-indicator\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.indicator\"\n          [config]=\"indicatorConfig\"\n        ></ircc-cl-lib-indicator>\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconTrailing\"\n          class=\"icon-trailing\"\n          [config]=\"{ FA_keywords: config?.iconTrailing || '' }\"\n        ></ircc-cl-lib-icon>\n      </a>\n    </ng-container>\n    <ng-template #externalLink>\n      <a\n        #externalLinkA\n        target=\"_blank\"\n        [attr.href]=\"\n          config?.href + (config?.anchor ? '#' + config.anchor : '') || ''\n            | translate\n        \"\n      >\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconLeading\"\n          class=\"icon-left\"\n          [config]=\"{ FA_keywords: config?.iconLeading || '' }\"\n        ></ircc-cl-lib-icon>\n        <p>{{ config?.label || '' | translate }} {{ config.size }}</p>\n        <ircc-cl-lib-indicator\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.indicator\"\n          [config]=\"indicatorConfig\"\n        ></ircc-cl-lib-indicator>\n        <ircc-cl-lib-icon\n          [attr.size]=\"config.size\"\n          tabindex=\"-1\"\n          *ngIf=\"config?.iconTrailing\"\n          class=\"icon-trailing\"\n          [config]=\"{ FA_keywords: config?.iconTrailing || '' }\"\n        ></ircc-cl-lib-icon>\n      </a>\n    </ng-template>\n  </div>\n  <div>\n    <ng-content></ng-content>\n  </div>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }, { type: i1.NavigationService }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { externalLinkA: [{
                type: ViewChild,
                args: ['externalLinkA', { static: false }]
            }], internalLink: [{
                type: ViewChild,
                args: ['internalLink', { static: false }]
            }], config: [{
                type: Input
            }], id: [{
                type: Input
            }], size: [{
                type: Input
            }], indicator: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2LWl0ZW0tbmF2LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2NvbXBvbmVudC1saWIvc3JjL2xpYi9zaGFyZWQvbmF2aWdhdGlvbi9uYXYtaXRlbS1uYXYvbmF2LWl0ZW0tbmF2LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2NvbXBvbmVudC1saWIvc3JjL2xpYi9zaGFyZWQvbmF2aWdhdGlvbi9uYXYtaXRlbS1uYXYvbmF2LWl0ZW0tbmF2LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxLQUFLLEVBR0wsU0FBUyxFQUVWLE1BQU0sZUFBZSxDQUFDO0FBR3ZCLE9BQU8sRUFBRSxTQUFTLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFRbEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsTUFBTSxNQUFNLENBQUM7Ozs7Ozs7O0FBTzVDLDRDQUE0QztBQUM1QyxNQUFNLE9BQU8sbUJBQW1CO0lBcUQ5QixZQUNVLFFBQW1CLEVBQ25CLFFBQTJCLEVBQzNCLEdBQXNCO1FBRnRCLGFBQVEsR0FBUixRQUFRLENBQVc7UUFDbkIsYUFBUSxHQUFSLFFBQVEsQ0FBbUI7UUFDM0IsUUFBRyxHQUFILEdBQUcsQ0FBbUI7UUEvQ2hDLDJGQUEyRjtRQUNsRixXQUFNLEdBQXdCO1lBQ3JDLEVBQUUsRUFBRSxFQUFFO1lBQ04sSUFBSSxFQUFFLEVBQUU7WUFDUixNQUFNLEVBQUUsRUFBRTtZQUNWLFFBQVEsRUFBRSxLQUFLO1lBQ2YsTUFBTSxFQUFFLEtBQUs7WUFDYixLQUFLLEVBQUUsRUFBRTtZQUNULFdBQVcsRUFBRSxFQUFFO1lBQ2YsWUFBWSxFQUFFLEVBQUU7WUFDaEIsSUFBSSxFQUFFLE1BQU07WUFDWixRQUFRLEVBQUUsRUFBRTtZQUNaLE1BQU0sRUFBRSxLQUFLO1NBQ2QsQ0FBQztRQUVPLE9BQUUsR0FBVyxFQUFFLENBQUM7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SUFBSTtzQkFBWixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBSZW5kZXJlcjIsXG4gIElucHV0LFxuICBTaW1wbGVDaGFuZ2VzLFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgVmlld0NoaWxkLFxuICBFbGVtZW50UmVmXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSXNBY3RpdmVNYXRjaE9wdGlvbnMgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgRFNTaXplcyB9IGZyb20gJy4uLy4uLy4uLy4uL3NoYXJlZC9jb25zdGFudHMvamwtY29tcG9uZW50cy5jb25zdGFudHMnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIElOYXZpZ2F0aW9uSW5kaWNhdG9yLFxuICBJTmF2aWdhdGlvbkl0ZW1IZWFkaW5nLFxuICBJTmF2aWdhdGlvbkl0ZW1MaW5rXG59IGZyb20gJy4uL25hdmlnYXRpb24udHlwZXMnO1xuaW1wb3J0IHsgSUluZGljYXRvckNvbmZpZyB9IGZyb20gJy4uLy4uL2luZGljYXRvci9pbmRpY2F0b3IuY29tcG9uZW50JztcbmltcG9ydCB7IE5hdmlnYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vbmF2aWdhdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgZmlsdGVyIH0gZnJvbSAncnhqcyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2lyY2MtY2wtbGliLW5hdi1pdGVtJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25hdi1pdGVtLW5hdi5jb21wb25lbnQuaHRtbCdcbn0pXG5cbi8vVE9ETzogRml4IGNsYXNzIG5hbWUgKE5hdkl0ZW1OYXZDb21wb25lbnQpXG5leHBvcnQgY2xhc3MgbmF2SXRlbU5hdkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBWaWV3Q2hpbGQoJ2V4dGVybmFsTGlua0EnLCB7IHN0YXRpYzogZmFsc2UgfSkgZXh0ZXJuYWxMaW5rQTpcbiAgICB8IEVsZW1lbnRSZWZcbiAgICB8IHVuZGVmaW5lZDtcblxuICBAVmlld0NoaWxkKCdpbnRlcm5hbExpbmsnLCB7IHN0YXRpYzogZmFsc2UgfSkgaW50ZXJuYWxMaW5rOlxuICAgIHwgRWxlbWVudFJlZlxuICAgIHwgdW5kZWZpbmVkO1xuXG4gIC8vVE9ETzogUGF0dGVybiBpcyBzdXBwb3NlZCB0byBiZSB0aGF0IGFueSBlbGVtZW50cyB0aGF0IG1heSBub3QgYmUgdXNlZCBzaG91bGQgYmUgT1BUSU9OQUxcbiAgQElucHV0KCkgY29uZmlnOiBJTmF2aWdhdGlvbkl0ZW1MaW5rID0ge1xuICAgIGlkOiAnJyxcbiAgICBocmVmOiAnJyxcbiAgICBhbmNob3I6ICcnLFxuICAgIGV4dGVybmFsOiBmYWxzZSxcbiAgICBib3JkZXI6IGZhbHNlLFxuICAgIGxhYmVsOiAnJyxcbiAgICBpY29uTGVhZGluZzogJycsXG4gICAgaWNvblRyYWlsaW5nOiAnJyxcbiAgICB0eXBlOiAnbGluaycsXG4gICAgY2hpbGRyZW46IFtdLFxuICAgIGhlYWRlcjogZmFsc2VcbiAgfTtcblxuICBASW5wdXQoKSBpZDogc3RyaW5nID0gJyc7XG4gIEBJbnB1dCgpIHNpemU/OiBrZXlvZiB0eXBlb2YgRFNTaXplcztcbiAgQElucHV0KCkgaW5kaWNhdG9yPzogSU5hdmlnYXRpb25JbmRpY2F0b3I7XG5cbiAgaW5kaWNhdG9yQ29uZmlnOiBJSW5kaWNhdG9yQ29uZmlnID0ge1xuICAgIGNhdGVnb3J5OiAnd2VhaycsXG4gICAgcHVycG9zZTogJ3N0YXR1cycsXG4gICAgdHlwZTogJ2RvdCcsXG4gICAgdGFiSW5kZXg6IC0xXG4gIH07XG5cbiAgaGVhZGVyQ29uZmlnOiBJTmF2aWdhdGlvbkl0ZW1IZWFkaW5nID0ge1xuICAgIGljb25MZWFkaW5nOiAnJyxcbiAgICBpZDogJ2hlYWRlcl9saW5rJyxcbiAgICBsYWJlbDogJ0hlYWRlciBUaXRsZScsXG4gICAgdHlwZTogJ2hlYWRpbmcnLFxuICAgIGNoaWxkcmVuOiBbXVxuICB9O1xuXG4gIC8vIENoZWNrIGlmIGN1cnJlbnQgdXJsJ3MgZnJhZ21lbnQgbWF0Y2hcbiAgZnJhZ01hdGNoT3B0aW9uczogSXNBY3RpdmVNYXRjaE9wdGlvbnMgPSB7XG4gICAgICBxdWVyeVBhcmFtczogJ2lnbm9yZWQnLFxuICAgICAgbWF0cml4UGFyYW1zOiAnZXhhY3QnLFxuICAgICAgcGF0aHM6ICdleGFjdCcsXG4gICAgICBmcmFnbWVudDogJ2V4YWN0J1xuICB9O1xuXG4gIG5hdk9iamVjdENoYW5nZVN1YiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgcHJpdmF0ZSBuYXZFdmVudDogTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgcHJpdmF0ZSBjZHI6IENoYW5nZURldGVjdG9yUmVmXG4gICkge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICAvL1VzZWQgZW50aXJlbHkgYXMgYSB3b3JrYXJvdW5kIGZvciB0aGUgY2hhbmdlIGRldGVjdGlvbiBsaW1pdGF0aW9uc1xuICAgIHRoaXMubmF2T2JqZWN0Q2hhbmdlU3ViID0gdGhpcy5uYXZFdmVudC5pdGVtQ2hhbmdlT2JzJFxuICAgICAgLnBpcGUoZmlsdGVyKChpdGVtKSA9PiBpdGVtID09PSB0aGlzLmNvbmZpZy5pZCkpXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JDb25maWcuc3RhdHVzID0gdGhpcy5jb25maWcuaW5kaWNhdG9yPy5zdGF0dXM7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yQ29uZmlnLmljb24gPSB0aGlzLmNvbmZpZy5pbmRpY2F0b3I/Lmljb247XG4gICAgICB9KTtcblxuICAgIHRoaXMuaWQgIT09ICcnID8gKHRoaXMuY29uZmlnLmlkID0gdGhpcy5pZCkgOiB1bmRlZmluZWQ7XG4gICAgaWYgKHRoaXMuY29uZmlnLmluZGljYXRvcikge1xuICAgICAgdGhpcy5pbmRpY2F0b3JDb25maWcgPSB7XG4gICAgICAgIHR5cGU6ICdkb3QnLFxuICAgICAgICBjYXRlZ29yeTogJ3dlYWsnLFxuICAgICAgICBwdXJwb3NlOiAnc3RhdHVzJyxcbiAgICAgICAgc3RhdHVzOiB0aGlzLmNvbmZpZy5pbmRpY2F0b3Iuc3RhdHVzLFxuICAgICAgICBpY29uOiB0aGlzLmNvbmZpZy5pbmRpY2F0b3IuaWNvbixcbiAgICAgICAgdGFiSW5kZXg6IC0xXG4gICAgICB9O1xuICAgICAgdGhpcy5jb25maWcuaW5kaWNhdG9yLmxhYmVsXG4gICAgICAgID8gKHRoaXMuaW5kaWNhdG9yQ29uZmlnID0ge1xuICAgICAgICAgICAgLi4udGhpcy5pbmRpY2F0b3JDb25maWcsXG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICBsYWJlbDogdGhpcy5jb25maWcuaW5kaWNhdG9yLmxhYmVsLFxuICAgICAgICAgICAgdGFiSW5kZXg6IC0xXG4gICAgICAgICAgfSlcbiAgICAgICAgOiBudWxsO1xuICAgICAgdGhpcy5zaXplXG4gICAgICAgID8gKHRoaXMuaW5kaWNhdG9yQ29uZmlnID0geyAuLi50aGlzLmluZGljYXRvckNvbmZpZywgc2l6ZTogdGhpcy5zaXplIH0pXG4gICAgICAgIDogbnVsbDtcbiAgICB9XG4gICAgdGhpcy5zaXplICE9PSB1bmRlZmluZWQgPyAodGhpcy5jb25maWcuc2l6ZSA9IHRoaXMuc2l6ZSkgOiB1bmRlZmluZWQ7XG4gIH1cblxuICBsaW5rQ2xpY2soZTogRXZlbnQpIHtcbiAgICB0aGlzLm5hdkV2ZW50Lm5hdkV2ZW50KHsgaWQ6IHRoaXMuY29uZmlnLmlkLCBldmVudDogZSB9KTsgLy9Ccm9hZGNhc3QgdGhlIGV2ZW50XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5leHRlcm5hbCkge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmNvbmZpZz8uYW5jaG9yKSB7XG4gICAgICAgICAgY29uc3QgYW5jaG9yRWxlbWVudCA9IHRoaXMucmVuZGVyZXIuc2VsZWN0Um9vdEVsZW1lbnQoXG4gICAgICAgICAgICBgIyR7dGhpcy5jb25maWcuYW5jaG9yfWAsXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICAgKTtcbiAgICAgICAgICBhbmNob3JFbGVtZW50XG4gICAgICAgICAgICA/IGFuY2hvckVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSlcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSwgMCk7XG4gICAgfVxuICB9XG5cbiAgZW50ZXJQcmVzcyhldmVudDogYW55KSB7XG4gICAgaWYgKHRoaXMuY29uZmlnLmV4dGVybmFsKSB7XG4gICAgICB0aGlzLmV4dGVybmFsTGlua0E/Lm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pbnRlcm5hbExpbms/Lm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB9XG4gIH1cbn1cbiIsIjxkaXZcbiAgW2lkXT1cImNvbmZpZy5pZFwiXG4gIGNsYXNzPVwibGliLW5hdi1pdGVtXCJcbiAgW25nQ2xhc3NdPVwiY29uZmlnPy5ib3JkZXIgPyAnYm9yZGVyLWxlZnQnIDogbnVsbFwiXG4gIChrZXlkb3duLmVudGVyKT1cImVudGVyUHJlc3MoJGV2ZW50KVwiXG4+XG4gIDxkaXY+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImNvbmZpZz8uZXh0ZXJuYWwgIT09IHRydWU7IGVsc2UgZXh0ZXJuYWxMaW5rXCI+XG4gICAgICA8YVxuICAgICAgICBbcm91dGVyTGlua109XCJjb25maWc/LmhyZWYgfHwgJycgfCB0cmFuc2xhdGVcIlxuICAgICAgICBbZnJhZ21lbnRdPVwiY29uZmlnPy5hbmNob3JcIlxuICAgICAgICBbcm91dGVyTGlua0FjdGl2ZV09XCInYWN0aXZlLWxpbmsnXCJcbiAgICAgICAgW3JvdXRlckxpbmtBY3RpdmVPcHRpb25zXT1cImZyYWdNYXRjaE9wdGlvbnNcIlxuICAgICAgICAoY2xpY2spPVwibGlua0NsaWNrKCRldmVudClcIlxuICAgICAgICAjaW50ZXJuYWxMaW5rXG4gICAgICA+XG4gICAgICAgIDxpcmNjLWNsLWxpYi1pY29uXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgKm5nSWY9XCJjb25maWc/Lmljb25MZWFkaW5nXCJcbiAgICAgICAgICBjbGFzcz1cImljb24tbGVmdFwiXG4gICAgICAgICAgW2NvbmZpZ109XCJ7IEZBX2tleXdvcmRzOiBjb25maWc/Lmljb25MZWFkaW5nIHx8ICcnIH1cIlxuICAgICAgICA+PC9pcmNjLWNsLWxpYi1pY29uPlxuICAgICAgICA8cCAqbmdJZj1cImNvbmZpZz8uaGVhZGVyICE9PSB0cnVlXCI+XG4gICAgICAgICAge3sgY29uZmlnPy5sYWJlbCB8fCAnJyB8IHRyYW5zbGF0ZSB9fVxuICAgICAgICA8L3A+XG4gICAgICAgIDxoMlxuICAgICAgICAgICpuZ0lmPVwiY29uZmlnPy5oZWFkZXIgPT09IHRydWVcIlxuICAgICAgICAgIGNsYXNzPVwiaDVcIlxuICAgICAgICA+XG4gICAgICAgICAge3sgY29uZmlnPy5sYWJlbCB8fCAnJyB8IHRyYW5zbGF0ZSB9fVxuICAgICAgICA8L2gyPlxuICAgICAgICA8IS0tIDxpcmNjLWNsLWxpYi1uYXYtaGVhZGVyXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgICAgW3NpemVdPVwiY29uZmlnLnNpemVcIlxuICAgICAgICAgIFtsYWJlbF09XCJcIlxuICAgICAgICAgICpuZ0lmPVwiY29uZmlnPy5oZWFkZXIgPT09IHRydWVcIlxuICAgICAgICA+XG4gICAgICAgIDwvaXJjYy1jbC1saWItbmF2LWhlYWRlcj4gLS0+XG4gICAgICAgIDxpcmNjLWNsLWxpYi1pbmRpY2F0b3JcbiAgICAgICAgICBbYXR0ci5zaXplXT1cImNvbmZpZy5zaXplXCJcbiAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcbiAgICAgICAgICAqbmdJZj1cImNvbmZpZz8uaW5kaWNhdG9yXCJcbiAgICAgICAgICBbY29uZmlnXT1cImluZGljYXRvckNvbmZpZ1wiXG4gICAgICAgID48L2lyY2MtY2wtbGliLWluZGljYXRvcj5cbiAgICAgICAgPGlyY2MtY2wtbGliLWljb25cbiAgICAgICAgICBbYXR0ci5zaXplXT1cImNvbmZpZy5zaXplXCJcbiAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcbiAgICAgICAgICAqbmdJZj1cImNvbmZpZz8uaWNvblRyYWlsaW5nXCJcbiAgICAgICAgICBjbGFzcz1cImljb24tdHJhaWxpbmdcIlxuICAgICAgICAgIFtjb25maWddPVwieyBGQV9rZXl3b3JkczogY29uZmlnPy5pY29uVHJhaWxpbmcgfHwgJycgfVwiXG4gICAgICAgID48L2lyY2MtY2wtbGliLWljb24+XG4gICAgICA8L2E+XG4gICAgPC9uZy1jb250YWluZXI+XG4gICAgPG5nLXRlbXBsYXRlICNleHRlcm5hbExpbms+XG4gICAgICA8YVxuICAgICAgICAjZXh0ZXJuYWxMaW5rQVxuICAgICAgICB0YXJnZXQ9XCJfYmxhbmtcIlxuICAgICAgICBbYXR0ci5ocmVmXT1cIlxuICAgICAgICAgIGNvbmZpZz8uaHJlZiArIChjb25maWc/LmFuY2hvciA/ICcjJyArIGNvbmZpZy5hbmNob3IgOiAnJykgfHwgJydcbiAgICAgICAgICAgIHwgdHJhbnNsYXRlXG4gICAgICAgIFwiXG4gICAgICA+XG4gICAgICAgIDxpcmNjLWNsLWxpYi1pY29uXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgKm5nSWY9XCJjb25maWc/Lmljb25MZWFkaW5nXCJcbiAgICAgICAgICBjbGFzcz1cImljb24tbGVmdFwiXG4gICAgICAgICAgW2NvbmZpZ109XCJ7IEZBX2tleXdvcmRzOiBjb25maWc/Lmljb25MZWFkaW5nIHx8ICcnIH1cIlxuICAgICAgICA+PC9pcmNjLWNsLWxpYi1pY29uPlxuICAgICAgICA8cD57eyBjb25maWc/LmxhYmVsIHx8ICcnIHwgdHJhbnNsYXRlIH19IHt7IGNvbmZpZy5zaXplIH19PC9wPlxuICAgICAgICA8aXJjYy1jbC1saWItaW5kaWNhdG9yXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgKm5nSWY9XCJjb25maWc/LmluZGljYXRvclwiXG4gICAgICAgICAgW2NvbmZpZ109XCJpbmRpY2F0b3JDb25maWdcIlxuICAgICAgICA+PC9pcmNjLWNsLWxpYi1pbmRpY2F0b3I+XG4gICAgICAgIDxpcmNjLWNsLWxpYi1pY29uXG4gICAgICAgICAgW2F0dHIuc2l6ZV09XCJjb25maWcuc2l6ZVwiXG4gICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgKm5nSWY9XCJjb25maWc/Lmljb25UcmFpbGluZ1wiXG4gICAgICAgICAgY2xhc3M9XCJpY29uLXRyYWlsaW5nXCJcbiAgICAgICAgICBbY29uZmlnXT1cInsgRkFfa2V5d29yZHM6IGNvbmZpZz8uaWNvblRyYWlsaW5nIHx8ICcnIH1cIlxuICAgICAgICA+PC9pcmNjLWNsLWxpYi1pY29uPlxuICAgICAgPC9hPlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIDwvZGl2PlxuICA8ZGl2PlxuICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgPC9kaXY+XG48L2Rpdj5cbiJdfQ==